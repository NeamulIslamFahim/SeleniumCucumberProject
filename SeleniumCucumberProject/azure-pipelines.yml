trigger:
  branches:
    include:
      - '*'        # Run pipeline on ANY branch

pool:
  vmImage: 'ubuntu-latest'   # Works on any agent pool

steps:
# -------------------------
# Install & Setup JDK
# -------------------------
- task: JavaToolInstaller@0
  inputs:
    versionSpec: '17'         # Use JDK 17 (recommended)
    jdkArchitectureOption: x64
    jdkSourceOption: PreInstalled

# -------------------------
# Build & Test with Maven
# -------------------------
- task: Maven@3
  inputs:
    mavenPomFile: 'pom.xml'
    mavenOptions: '-Xmx3072m'
    javaHomeOption: 'Path'
    jdkDirectory: '/usr/lib/jvm/msopenjdk-17-amd64'
    publishJUnitResults: true
    testResultsFiles: '**/surefire-reports/TEST-*.xml'
    goals: 'clean install'

  condition: always()

# -------------------------
# Publish Build Artifact
# (JAR/WAR â€” so you can run it anywhere)
# -------------------------
- task: PublishBuildArtifacts@1
  inputs:
    PathtoPublish: 'target'
    ArtifactName: 'java-build'
    publishLocation: 'Container'
